(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6b5f3090"],{2532:function(t,e,n){"use strict";var a=n("23e7"),i=n("5a34"),r=n("1d80"),s=n("ab13");a({target:"String",proto:!0,forced:!s("includes")},{includes:function(t){return!!~String(r(this)).indexOf(i(t),arguments.length>1?arguments[1]:void 0)}})},4585:function(t,e,n){"use strict";n("99af"),n("a15b"),n("baa5"),n("ac1f"),n("8a79"),n("5319"),n("498a"),n("96cf");var a=n("1da1"),i={methods:{makeToast:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.$bvToast.toast(e,{title:t,variant:n,solid:!0})}}},r=n("93ef"),s=n("9b92"),o=solid.auth,c=new SolidFileClient(o);e["a"]={mixins:[i],methods:{getStorage:function(t){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n,a,i,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=e.url.endsWith("#this")?e.url:e.url+"#this",t.next=3,solid.data[n].storage;case 3:if(a=t.sent,console.log(a),void 0!=a){t.next=24;break}return i=e.url.substring(0,e.url.lastIndexOf("/")),t.next=9,solid.data[n].vcard$fn;case 9:return r=t.sent,o="".concat(r).trim().replace(/\s/g,"_"),console.log("".concat(r),e.url,o),a=[i,o,""].join("/"),console.log(a),t.next=16,!c.itemExists(e.storage);case 16:if(!t.sent){t.next=21;break}return t.next=19,c.createFolder(e.storage);case 19:t.next=22;break;case 21:case 22:return t.next=24,solid.data[n]["http://www.w3.org/ns/pim/space#storage"].set(Object(s["namedNode"])(a));case 24:return t.abrupt("return",a);case 25:case"end":return t.stop()}}),t)})))()},join:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("join to create inbox folder with authenticated agent as submitter"),n="@prefix :      <#> .\n      @prefix as:    <https://www.w3.org/ns/activitystreams#> .\n\n      :it\n      a as:Offer ;\n      as:actor <".concat(t.webId,'> ;\n      as:object :join ;\n      as:summary "').concat(t.webId,' asks to join the group" ;\n      as:target <').concat(t.invitation,"> .\n\n      :join\n      a as:Join ;\n      as:actor <").concat(t.webId,"> ;\n      as:object <").concat(t.invitation,'> ;\n      as:summary "').concat(t.webId,' joins group" .\n      '),e.prev=2,e.next=5,Object(r["f"])(t.inbox,new Blob([n],{type:"text/turtle"}));case 5:e.sent,t.makeToast("Join request sent","A request has been sent to group Inbox","success"),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](2),t.makeToast("Join request","Can not send a request to the Group Inbox"+e.t0,"danger");case 12:case"end":return e.stop()}}),e,null,[[2,9]])})))()},accept:function(){console.log("todo accept"),this.makeToast("Todo","not implemented yet")},invite:function(){console.log("todo invite"),this.makeToast("Todo","not implemented yet")},reject:function(){console.log("todo reject"),this.makeToast("Todo","not implemented yet")}}}},"487a":function(t,e,n){(function(e,n){t.exports=n()})(0,(function(){"use strict";var t="@@InfiniteScroll",e=function(t,e){var n,a,i,r,s,o=function(){t.apply(r,s),a=n};return function(){if(r=this,s=arguments,n=Date.now(),i&&(clearTimeout(i),i=null),a){var t=e-(n-a);t<0?o():i=setTimeout((function(){o()}),t)}else o()}},n=function(t){return t===window?Math.max(window.pageYOffset||0,document.documentElement.scrollTop):t.scrollTop},a=document.defaultView.getComputedStyle,i=function(t){var e=t;while(e&&"HTML"!==e.tagName&&"BODY"!==e.tagName&&1===e.nodeType){var n=a(e).overflowY;if("scroll"===n||"auto"===n)return e;e=e.parentNode}return window},r=function(t){return t===window?document.documentElement.clientHeight:t.clientHeight},s=function(t){return t===window?n(window):t.getBoundingClientRect().top+n(window)},o=function(t){var e=t.parentNode;while(e){if("HTML"===e.tagName)return!0;if(11===e.nodeType)return!1;e=e.parentNode}return!1},c=function(){if(!this.binded){this.binded=!0;var t=this,n=t.el,a=n.getAttribute("infinite-scroll-throttle-delay"),r=200;a&&(r=Number(t.vm[a]||a),(isNaN(r)||r<0)&&(r=200)),t.throttleDelay=r,t.scrollEventTarget=i(n),t.scrollListener=e(l.bind(t),t.throttleDelay),t.scrollEventTarget.addEventListener("scroll",t.scrollListener),this.vm.$on("hook:beforeDestroy",(function(){t.scrollEventTarget.removeEventListener("scroll",t.scrollListener)}));var s=n.getAttribute("infinite-scroll-disabled"),o=!1;s&&(this.vm.$watch(s,(function(e){t.disabled=e,!e&&t.immediateCheck&&l.call(t)})),o=Boolean(t.vm[s])),t.disabled=o;var c=n.getAttribute("infinite-scroll-distance"),u=0;c&&(u=Number(t.vm[c]||c),isNaN(u)&&(u=0)),t.distance=u;var d=n.getAttribute("infinite-scroll-immediate-check"),f=!0;d&&(f=Boolean(t.vm[d])),t.immediateCheck=f,f&&l.call(t);var h=n.getAttribute("infinite-scroll-listen-for-event");h&&t.vm.$on(h,(function(){l.call(t)}))}},l=function(t){var e=this.scrollEventTarget,a=this.el,i=this.distance;if(!0===t||!this.disabled){var o=n(e),c=o+r(e),l=!1;if(e===a)l=e.scrollHeight-c<=i;else{var u=s(a)-s(e)+a.offsetHeight+o;l=c+i>=u}l&&this.expression&&this.expression()}},u={bind:function(e,n,a){e[t]={el:e,vm:a.context,expression:n.value};var i=arguments;e[t].vm.$on("hook:mounted",(function(){e[t].vm.$nextTick((function(){o(e)&&c.call(e[t],i),e[t].bindTryCount=0;var n=function n(){e[t].bindTryCount>10||(e[t].bindTryCount++,o(e)?c.call(e[t],i):setTimeout(n,50))};n()}))}))},unbind:function(e){e&&e[t]&&e[t].scrollEventTarget&&e[t].scrollEventTarget.removeEventListener("scroll",e[t].scrollListener)}},d=function(t){t.directive("InfiniteScroll",u)};return window.Vue&&(window.infiniteScroll=u,Vue.use(d)),u.install=d,u}))},"4b6f":function(t,e,n){"use strict";n("dfa4")},"99af":function(t,e,n){"use strict";var a=n("23e7"),i=n("d039"),r=n("e8b5"),s=n("861d"),o=n("7b0b"),c=n("50c4"),l=n("8418"),u=n("65f0"),d=n("1dde"),f=n("b622"),h=n("2d00"),m=f("isConcatSpreadable"),g=9007199254740991,p="Maximum allowed index exceeded",v=h>=51||!i((function(){var t=[];return t[m]=!1,t.concat()[0]!==t})),b=d("concat"),w=function(t){if(!s(t))return!1;var e=t[m];return void 0!==e?!!e:r(t)},x=!v||!b;a({target:"Array",proto:!0,forced:x},{concat:function(t){var e,n,a,i,r,s=o(this),d=u(s,0),f=0;for(e=-1,a=arguments.length;e<a;e++)if(r=-1===e?s:arguments[e],w(r)){if(i=c(r.length),f+i>g)throw TypeError(p);for(n=0;n<i;n++,f++)n in r&&l(d,f,r[n])}else{if(f>=g)throw TypeError(p);l(d,f++,r)}return d.length=f,d}})},a15b:function(t,e,n){"use strict";var a=n("23e7"),i=n("44ad"),r=n("fc6a"),s=n("a640"),o=[].join,c=i!=Object,l=s("join",",");a({target:"Array",proto:!0,forced:c||!l},{join:function(t){return o.call(r(this),void 0===t?",":t)}})},c975:function(t,e,n){"use strict";var a=n("23e7"),i=n("4d64").indexOf,r=n("a640"),s=n("ae40"),o=[].indexOf,c=!!o&&1/[1].indexOf(1,-0)<0,l=r("indexOf"),u=s("indexOf",{ACCESSORS:!0,1:0});a({target:"Array",proto:!0,forced:c||!l||!u},{indexOf:function(t){return c?o.apply(this,arguments)||0:i(this,t,arguments.length>1?arguments[1]:void 0)}})},caad:function(t,e,n){"use strict";var a=n("23e7"),i=n("4d64").includes,r=n("44d2"),s=n("ae40"),o=s("indexOf",{ACCESSORS:!0,1:0});a({target:"Array",proto:!0,forced:!o},{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r("includes")},cbc6:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"chat-list"},[n("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],staticClass:"container",attrs:{"infinite-scroll-disabled":"busy","infinite-scroll-distance":"300"}},[0==t.data.length?n("div",[t._v("Please Wait, I'm loading data ;-)")]):t._e(),n("b-list-group",{attrs:{flush:""}},t._l(t.data,(function(e){return n("b-list-group-item",{key:e.id},[n("div",{staticClass:"item"},[n("div",{staticClass:"avatar"}),n("div",{staticClass:"created"},[t._v(" "+t._s(e.created)+" ")]),n("div",{staticClass:"maker text-info"},[n("UserName",{attrs:{webId:e.maker}})],1),n("div",{staticClass:"content"},[t._v(" "+t._s(e.content)+" ")])])])})),1)],1),n("b-alert",{staticClass:"position-fixed fixed-bottom rounded-0",staticStyle:{"z-index":"2000",bottom:"30px"},attrs:{variant:"info",dismissible:""},model:{value:t.busy,callback:function(e){t.busy=e},expression:"busy"}},[t._v(t._s(t.title)+" ")]),n("SolidChatSend",{attrs:{url:t.url}})],1)},i=[],r=(n("99af"),n("4de4"),n("caad"),n("c975"),n("a15b"),n("baa5"),n("d81d"),n("fb6a"),n("d3b7"),n("ac1f"),n("8a79"),n("2532"),n("1276"),n("b85c")),s=(n("96cf"),n("1da1")),o=n("487a"),c=n.n(o),l=n("4d8d"),u=n("6dc1"),d=n("4585"),f=solid.auth,h=new SolidFileClient(f),m={name:"SolidChatList",directives:{infiniteScroll:c.a},mixins:[d["a"]],props:["url"],components:{SolidChatSend:function(){return n.e("chunk-aa876e0e").then(n.bind(null,"f345"))},UserName:function(){return n.e("chunk-2d21ee7d").then(n.bind(null,"d80c"))}},data:function(){return{data:[],busy:!0,title:"Select a channel",index_cat:'@prefix : <#>.\n      @prefix XML: <http://www.w3.org/2001/XMLSchema#>.\n      @prefix c: </profile/card#>.\n      @prefix mee: <http://www.w3.org/ns/pim/meeting#>.\n      @prefix n1: <http://purl.org/dc/elements/1.1/>.\n      @prefix ui: <http://www.w3.org/ns/ui#>.\n      @prefix ic: <http://www.w3.org/2002/12/cal/ical#>.\n      @prefix flow: <http://www.w3.org/2005/01/wf/flow#>.\n\n      :id1606695592333\n      ic:dtstart "2020-11-30T00:19:52Z"^^XML:dateTime;\n      flow:participant c:me;\n      ui:backgroundColor "#eac1e3".\n      :this\n      a mee:LongChat;\n      n1:author c:me;\n      n1:created "2020-11-30T00:19:48Z"^^XML:dateTime;\n      n1:title "Chat channel";\n      flow:participation :id1606695592333;\n      ui:sharedPreferences :SharedPreferences.'}},created:function(){this.update()},methods:{update:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log(t.url),e.next=3,t.getStorage(t.url);case 3:return n=e.sent,t.storage="".concat(n)+"chat/",a=t.storage+"index.ttl",e.next=8,h.itemExists(a);case 8:if(e.sent){e.next=11;break}return e.next=11,h.createFile(a,t.index_cat,"text/turtle");case 11:console.log(t.storage),t.data=[],t.limite=new Date("2020-11-01"),t.initChat(t.storage);case 15:case"end":return e.stop()}}),e)})))()},channelChanged:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=t.created,e.limite=new Date(a),e.date=new Date,e.url=e.channel.substr(0,e.channel.lastIndexOf("/")+1),console.log("url",e.url),e.data=[],n.next=8,e.initChat(e.url);case 8:case"end":return n.stop()}}),n)})))()},loadMore:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.busy=!0,!(this.limite<=this.date)){t.next=9;break}return e=[this.root,this.date.getFullYear(),("0"+(this.date.getMonth()+1)).slice(-2),("0"+this.date.getDate()).slice(-2),"chat.ttl"].join("/"),this.date.setDate(this.date.getDate()-1),this.title="loading "+this.date.toLocaleDateString(),t.next=7,this.loadMessages(e,"bottom");case 7:t.next=11;break;case 9:this.data.push({id:Math.random(),maker:"https://System.solid-vue-panes",content:"This is the end, my friend, there are no message before that date",created:this.limite.toLocaleString()}),this.makeToast("No message before",this.limite.toLocaleString(),"warning");case 11:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),loadMessages:function(t,e){var n=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var i,s,o,c,d,f,h,m,g,p,v;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(l["b"])(t);case 3:i=a.sent,s=i.findSubjects(),s=s.filter(n.onlyUnique),o=[],c=n.data.map((function(t){return t.id})),d=Object(r["a"])(s);try{for(d.s();!(f=d.n()).done;)h=f.value,h.asRef()==n.root+"/index.ttl#this"||c.includes(h.asRef())||(m=h.getString(u["a"].created),g=h.getLiteral(u["f"].content),p=h.getNodeRef(u["b"].maker)||"anonymous",v={id:h.asRef(),created:new Date(m).toLocaleString(),content:g,maker:p},o.unshift(v))}catch(b){d.e(b)}finally{d.f()}"top"==e?(n.today_messages=[],n.today_messages=o):n.old_messages.push.apply(n.old_messages,o),n.data=[],n.data=n.today_messages.concat(n.old_messages),a.next=17;break;case 15:a.prev=15,a.t0=a["catch"](0);case 17:n.busy=!1;case 18:case"end":return a.stop()}}),a,null,[[0,15]])})))()},loadMore1:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.busy=!0,!(this.limite<=this.date)){t.next=10;break}return e=[this.root,this.date.getFullYear(),("0"+(this.date.getMonth()+1)).slice(-2),("0"+this.date.getDate()).slice(-2),"chat.ttl"].join("/"),this.date.setDate(this.date.getDate()-1),this.title="loading "+this.date.toLocaleDateString(),t.next=7,this.updateMessages(e,"bottom");case 7:this.busy=!1,t.next=10;break;case 10:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),initChat:function(t){this.today_messages=[],this.old_messages=[],this.messages=[],this.data=[],this.stopped=!1,this.date=new Date,this.root=t,this.root.endsWith("/")&&(this.root=this.root.slice(0,-1)),this.fileUrl=[this.root,this.date.getFullYear(),("0"+(this.date.getMonth()+1)).slice(-2),("0"+this.date.getDate()).slice(-2),"chat.ttl"].join("/"),this.$store.commit("chat/setFileUrl",this.fileUrl),this.$store.commit("chat/setRoot",this.root);var e=this.root.split("//")[1],n=e.split("/")[0]+"/",a=new WebSocket("wss://"+n,["solid.0.1.0"]);a.onopen=function(){a.send("sub "+this.fileUrl)}.bind(this),a.onmessage=function(t){t.data&&"pub"===t.data.slice(0,3)&&this.updateMessages(t.data.substring(4),"top")}.bind(this),this.loadMore()},updateMessages:function(t,e){var n=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var i,s,o,c,d,f,h,m,g,p,v;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(l["b"])(t);case 3:i=a.sent,s=i.findSubjects(),s=s.filter(n.onlyUnique),o=[],c=n.data.map((function(t){return t.id})),d=Object(r["a"])(s);try{for(d.s();!(f=d.n()).done;)h=f.value,h.asRef()==n.root+"/index.ttl#this"||c.includes(h.asRef())||(m=h.getString(u["a"].created),g=h.getLiteral(u["f"].content),p=h.getNodeRef(u["b"].maker)||"anonymous",v={id:h.asRef(),created:new Date(m).toLocaleString(),content:g,maker:p},o.unshift(v),console.log(o))}catch(b){d.e(b)}finally{d.f()}"top"==e?(n.today_messages=[],n.today_messages=o):n.old_messages.push.apply(n.old_messages,o),n.data=[],n.data=n.today_messages.concat(n.old_messages),n.busy=!1,console.log("DATA",n.data,n.busy),a.next=19;break;case 17:a.prev=17,a.t0=a["catch"](0);case 19:case"end":return a.stop()}}),a,null,[[0,17]])})))()},makeToast:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.$bvToast.toast(e,{title:t,variant:n,solid:!0})},onlyUnique:function(t,e,n){return n.indexOf(t)===e}},watch:{},computed:{}},g=m,p=(n("4b6f"),n("2877")),v=Object(p["a"])(g,a,i,!1,null,null,null);e["default"]=v.exports},d81d:function(t,e,n){"use strict";var a=n("23e7"),i=n("b727").map,r=n("1dde"),s=n("ae40"),o=r("map"),c=s("map");a({target:"Array",proto:!0,forced:!o||!c},{map:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},dfa4:function(t,e,n){}}]);
//# sourceMappingURL=chunk-6b5f3090.2cd38c05.js.map